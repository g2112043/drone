dlarrayからdoubleなどへ変換すると内部で保持されている
トレースが破壊される。

そこでdlarrayのみで計算が行われるよう更新し、
modelLossの外部にあった関数を内部へ移動させた。

しかし、結果は全ての勾配の値がNaNとなる現象に直面した。
今度は0ではなくNaNだ。